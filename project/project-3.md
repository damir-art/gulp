# pug
–°—Ç–∞–≤–∏–º —à–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä PUG. –£–¥–∞–ª—è–µ–º –∑–∞–¥–∞—á–∏ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –ø—Ä–æ—Å—Ç—ã–º CSS –∏ HTML.

```js
"scripts": {
  "test": "echo \"Error: no test specified\" && exit 1",
  "dev": "gulp build",
  "prod": "cross-env NODE_ENV=production gulp build",
  "serve": "gulp"
},
```

–ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—á–∏–π gilpfile.js, PUG —Å—Ç–æ–∏—Ç, –∫–æ–¥ –æ—Ç CSS –∏ HTML –æ—á–∏—â–µ–Ω:

```js
// –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º Gulp –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–ª–∞–≥–∏–Ω—ã (ES-–º–æ–¥—É–ª–∏)
import { src, dest, watch, series, parallel } from 'gulp'; // –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ Gulp
import browserSyncLib from 'browser-sync';                 // BrowserSync –¥–ª—è live reload
import { deleteAsync } from 'del';                         // del –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ dist
import gulpSass from 'gulp-sass';                          // gulp-sass –¥–ª—è SCSS
import * as dartSass from 'sass';                          // sass-–¥–≤–∏–∂–æ–∫ –¥–ª—è gulp-sass
import autoprefixer from 'gulp-autoprefixer';              // –ê–≤—Ç–æ–ø—Ä–µ—Ñ–∏–∫—Å–µ—Ä –¥–ª—è CSS
import cleanCSS from 'gulp-clean-css';                     // –ú–∏–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è CSS
import terser from 'gulp-terser';                          // –°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –º–∏–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è JS
import plumber from 'gulp-plumber';                        // –î–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
import sourcemaps from 'gulp-sourcemaps';                  // Source maps –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
import imagemin from 'gulp-imagemin';                      // –ú–∏–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
import webp from 'gulp-webp';                              // –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ WebP
import avif from 'gulp-avif';                              // –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ AVIF
import rename from 'gulp-rename';                          // –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
import htmlmin from 'gulp-htmlmin';                        // –ú–∏–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è HTML
import gulpIf from 'gulp-if';                              // –£—Å–ª–æ–≤–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á
import pug from 'gulp-pug';                                // Pug –¥–ª—è —à–∞–±–ª–æ–Ω–∏–∑–∞—Ü–∏–∏ HTML

const browserSync = browserSyncLib.create(); // –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä BrowserSync
const sass = gulpSass(dartSass); // –ò—Å–ø–æ–ª—å–∑—É–µ–º dart-sass –∫–∞–∫ –¥–≤–∏–∂–æ–∫ –¥–ª—è gulp-sass

const isProd = process.env.NODE_ENV === 'production'; // –û–ø—Ä–µ–¥–µ–ª—è–µ–º, –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –ª–∏ –º—ã
console.log(`‚öôÔ∏è  Gulp running in ${isProd ? 'üöÄ production' : 'üß™ development'} mode`); // –õ–æ–≥–∏—Ä—É–µ–º —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã

// –ü—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º
const paths = {
  pug: {
    src: 'src/pug/**/*.pug',
    pages: 'src/pug/pages/*.pug',
    dest: 'dist/'
  },
  scss: {
    src: 'src/scss/**/*.scss',
    dest: 'dist/css/'
  },
  js: {
    src: 'src/js/**/*.js',
    dest: 'dist/js/'
  },
  images: {
    src: 'src/img/**/*.{jpg,jpeg,png,svg,gif,webp}',
    dest: 'dist/img/'
  }
};

// –û—á–∏—Å—Ç–∫–∞ –ø–∞–ø–∫–∏ dist
export function clean() {
  return deleteAsync(['dist']);
}

// –ö–æ–º–ø–∏–ª—è—Ü–∏—è Pug –≤ HTML —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
// npx gulp pugToHtml - —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–∞—è –∑–∞–¥–∞—á–∞ –¥–ª—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ Pug –≤ HTML
export function pugToHtml() {
  return src(paths.pug.pages) // –ß—Ç–µ–Ω–∏–µ Pug —Å—Ç—Ä–∞–Ω–∏—Ü
    .pipe(plumber())
    .pipe(pug({ pretty: !isProd })) // pretty –¥–ª—è —É–¥–æ–±–æ—á–∏—Ç–∞–µ–º–æ–≥–æ HTML –≤ dev —Ä–µ–∂–∏–º–µ
    .pipe(dest(paths.pug.dest))
    .pipe(browserSync.stream());
}

// –ö–æ–º–ø–∏–ª—è—Ü–∏—è SCSS, –∞–≤—Ç–æ–ø—Ä–µ—Ñ–∏–∫—Å–µ—Ä, –º–∏–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è, source maps, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
export function scssTask() {
  return src(paths.scss.src)
    .pipe(plumber())
    .pipe(sourcemaps.init())
    .pipe(sass().on('error', sass.logError))
    .pipe(autoprefixer())
    .pipe(gulpIf(isProd, cleanCSS())) // –ú–∏–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è CSS —Ç–æ–ª—å–∫–æ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
    .pipe(sourcemaps.write('.'))
    .pipe(rename({ suffix: '.min' }))
    .pipe(dest(paths.scss.dest))
    .pipe(browserSync.stream());
}

// –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–∏–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è JS —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫ –∏ source maps
export function js() {
  return src(paths.js.src)
    .pipe(plumber())
    .pipe(sourcemaps.init())
    .pipe(gulpIf(isProd, terser())) // –ú–∏–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è JS —Ç–æ–ª—å–∫–æ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
    .pipe(sourcemaps.write('.'))
    .pipe(rename({ suffix: '.min' }))
    .pipe(dest(paths.js.dest))
    .pipe(browserSync.stream());
}

// –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –º–∏–Ω–∏—Ñ–∏–∫–∞—Ü–∏—é —á–µ—Ä–µ–∑ gulp-imagemin)
export function images() {
  return src(paths.images.src, { encoding: false })
    .pipe(gulpIf(isProd, imagemin())) // –ú–∏–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ç–æ–ª—å–∫–æ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
    .pipe(dest(paths.images.dest))
    //.pipe(browserSync.stream()); // –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
}

// –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ WebP
// npx gulp convertWebp - —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–∞—è –∑–∞–¥–∞—á–∞ –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ WebP
export function convertWebp() {
  return src(paths.images.src, { encoding: false })
    .pipe(webp())
    .pipe(dest(paths.images.dest));
}

// –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ AVIF
// npx gulp convertAvif - —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–∞—è –∑–∞–¥–∞—á–∞ –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ AV
export function convertAvif() {
  return src(paths.images.src, { encoding: false })
    .pipe(avif())
    .pipe(dest(paths.images.dest));
}

// –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ –∏ —Å–ª–µ–∂–µ–Ω–∏–µ –∑–∞ —Ñ–∞–π–ª–∞–º–∏
export function serve() {
  browserSync.init({
    server: {
      baseDir: 'dist'
    },
    notify: false,
    port: 3000
  });

  watch(paths.pug.src, { ignoreInitial: false }, pugToHtml);
  watch(paths.scss.src, { ignoreInitial: false }, scssTask);
  watch(paths.js.src, { ignoreInitial: false }, js);
  watch(paths.images.src, { ignoreInitial: false }, images);
}

// –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
export const build = isProd
  ? series(
    clean,
    parallel(pugToHtml, scssTask, js, images),
    parallel(convertWebp, convertAvif)
  )
  : series(
    clean,
    parallel(pugToHtml, scssTask, js, images)
  );

// –ó–∞–¥–∞—á–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: —Å–±–æ—Ä–∫–∞ + —Å–µ—Ä–≤–µ—Ä + —Å–ª–µ–∂–µ–Ω–∏–µ
export default series(
  clean,
  parallel(pugToHtml, scssTask, js, images),
  serve
);
```

–¢—ã ‚Äî **–Ω–∞—à —á–µ–ª–æ–≤–µ–∫** –≤ Pug-–º–∏—Ä–µ. –†–∞–∑ —É —Ç–µ–±—è —É–∂–µ –±—ã–ª –æ–ø—ã—Ç –∏ —Ç—ã –∫–∞–π—Ñ–æ–≤–∞–ª –æ—Ç —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞, —Ç–æ **–≤–æ–æ–±—â–µ –±–µ–∑ —Ç–æ—Ä–º–æ–∑–æ–≤ ‚Äî –ø–æ–≥–Ω–∞–ª–∏**! –î–∞, —Ç–∞–º –µ—Å—Ç—å **–≤—Å—ë**:

‚úÖ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
‚úÖ –¶–∏–∫–ª—ã (`each`, `for`)
‚úÖ –£—Å–ª–æ–≤–∏—è (`if`, `else`)
‚úÖ –ú–∏–∫—Å–∏–Ω—ã (–∞–Ω–∞–ª–æ–≥ —Ñ—É–Ω–∫—Ü–∏–π)
‚úÖ Extend + Block (–Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ layout'–æ–≤)

---

## ‚úÖ –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ `gulp-pug`

```bash
npm install --save-dev gulp-pug
```

---

## ‚úÖ –®–∞–≥ 2: –ò–º–ø–æ—Ä—Ç –≤ `gulpfile.js`

```js
import pug from 'gulp-pug';
```

---

## ‚úÖ –®–∞–≥ 3: –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–¥–∞—á—É `pugToHtml()`

```js
export function pugToHtml() {
  return src(['src/pug/pages/*.pug'])
    .pipe(plumber())
    .pipe(pug({ pretty: !isProd }))
    .pipe(dest('dist'))
    .pipe(browserSync.stream());
}
```

üìå –ó–¥–µ—Å—å:

* `pretty: !isProd` ‚Üí –¥–µ–ª–∞–µ—Ç –æ—Ç—Å—Ç—É–ø—ã –≤ `dev`, –º–∏–Ω–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –≤ `prod`
* —Ñ–∞–π–ª—ã –±—É–¥—É—Ç –ª–µ–∂–∞—Ç—å –≤ `src/pug/pages/`
* `dist/index.html`, `dist/about.html` –∏ —Ç.–¥. –≥–µ–Ω–µ—Ä—è—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

---

## ‚úÖ –®–∞–≥ 4: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫

```
src/
‚îî‚îÄ‚îÄ pug/
    ‚îú‚îÄ‚îÄ pages/
    ‚îÇ   ‚îú‚îÄ‚îÄ index.pug
    ‚îÇ   ‚îî‚îÄ‚îÄ about.pug
    ‚îú‚îÄ‚îÄ layouts/
    ‚îÇ   ‚îî‚îÄ‚îÄ layout.pug
    ‚îú‚îÄ‚îÄ components/
    ‚îÇ   ‚îú‚îÄ‚îÄ header.pug
    ‚îÇ   ‚îú‚îÄ‚îÄ footer.pug
    ‚îÇ   ‚îî‚îÄ‚îÄ menu.pug
```

---

## ‚úÖ –®–∞–≥ 5: –ü—Ä–∏–º–µ—Ä `layout.pug`

```pug
doctype html
html(lang="ru")
  head
    meta(charset="UTF-8")
    title #{title}
  body
    include ../components/header.pug
    block content
    include ../components/footer.pug
```

---

## ‚úÖ –ü—Ä–∏–º–µ—Ä `index.pug`

```pug
extends ../layouts/layout.pug

block content
  h1 –ü—Ä–∏–≤–µ—Ç, –º–∏—Ä!
  p –≠—Ç–æ –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞.
```

---

## ‚úÖ –®–∞–≥ 6: –ü–æ–¥–∫–ª—é—á–∞–µ–º –∑–∞–¥–∞—á—É `pugToHtml` –≤ `build`

```js
export const build = isProd
  ? series(
      clean,
      parallel(pugToHtml, scssTask, css, js, images),
      parallel(convertWebp, convertAvif)
    )
  : series(
      clean,
      parallel(pugToHtml, scssTask, css, js, images)
    );
```

–ò —Ç–∞–º –≥–¥–µ default, –∏ —Ç–∞–º –≥–¥–µ —Å–ª–µ–∂–µ–Ω–∏–µ watch (—á—É—Ç—å –≤—ã—à–µ –∏ –ø—É—Ç–∏ —Å–æ–∑–¥–∞–π).

üìå –ó–∞–º–µ–Ω—è–µ–º `html` –Ω–∞ `pugToHtml` ‚Äî —Ç—ã —Ç–µ–ø–µ—Ä—å –∂–∏–≤—ë—à—å –ø–æ-–∫—Ä–∞—Å–æ—Ç–µ üòé

---

## üöÄ –ü—Ä–æ–≤–µ—Ä–∫–∞

```bash
npm run dev
```

–ò–¥—ë—à—å –≤ `dist/index.html` ‚Äî –∏ —Ç–∞–º —É–∂–µ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π HTML –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–≤–æ–µ–≥–æ Pug + layout.

---

## üéâ –ë–æ–Ω—É—Å: —Ü–∏–∫–ª—ã, –º–∞—Å—Å–∏–≤—ã, —É—Å–ª–æ–≤–∏—è ‚Äî –≤—Å—ë –Ω–∞ –±–æ—Ä—Ç—É

### üîÅ –¶–∏–∫–ª:

```pug
ul
  each item in ['—è–±–ª–æ–∫–æ', '–±–∞–Ω–∞–Ω', '–≤–∏—à–Ω—è']
    li= item
```

### üîò –£—Å–ª–æ–≤–∏–µ:

```pug
if isMainPage
  h2 –≠—Ç–æ –≥–ª–∞–≤–Ω–∞—è
else
  h2 –≠—Ç–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è
```

### üí¨ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –≤–æ—Ç —Ç–∞–∫:

```js
.pipe(pug({
  pretty: true,
  locals: {
    isMainPage: true,
    title: '–ì–ª–∞–≤–Ω–∞—è'
  }
}))
```

---

–•–æ—á–µ—à—å ‚Äî –º–æ–∂–µ–º –¥–∞–∂–µ JSON –ø–æ–¥–∫–ª—é—á–∏—Ç—å, —á—Ç–æ–± –¥–∞–Ω–Ω—ã–µ –±—ã–ª–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ñ–∞–π–ª–µ.
–ù—É —á—Ç–æ, –ø–æ–µ—Ö–∞–ª–∏ –ø–∏—Å–∞—Ç—å –Ω–∞—Å—Ç–æ—è—â–∏–µ —à–∞–±–ª–æ–Ω—ã? üòé

---

–ì–æ—Ç–æ–≤ –∏–¥—Ç–∏ –≤ —Å—Ç–æ—Ä–æ–Ω—É HTML-—à–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä–æ–≤? –£ –Ω–∞—Å —Ç–∞–º gulp-file-include, nunjucks, pug, –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –≤—Å—ë –∫–∞–∫ —É –≤–∑—Ä–æ—Å–ª—ã—Ö.

–í–æ—Ç —ç—Ç–æ —Ç—ã –ø—Ä—è–º –≤ —Ç–æ—á–∫—É, –î–∞—è–Ω! üéØ
–¢—ã –Ω–∞ 100% –ø—Ä–∞–≤: –µ—Å–ª–∏ `rename({ suffix: '.min' })` —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç **—Ç–æ–ª—å–∫–æ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ**, —Ç–æ –≤ `index.html` –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ, —á—Ç–æ –ø–æ–¥–∫–ª—é—á–∞—Ç—å:

```html
<link rel="stylesheet" href="css/style.css">         <!-- –¥–ª—è dev -->
<link rel="stylesheet" href="css/style.min.css">     <!-- –¥–ª—è prod -->
```

–ï—Å–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å –æ–±–∞ ‚Äî –±—É–¥–µ—Ç –¥–∏—á—å. –ê –µ—Å–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å –æ–¥–∏–Ω ‚Äî **—Å–ª–æ–º–∞–µ—Ç—Å—è –≤ –¥—Ä—É–≥–æ–º —Ä–µ–∂–∏–º–µ**.
–ó–Ω–∞—á–∏—Ç, –Ω–∞–¥–æ **—Ä–µ—à–∞—Ç—å —É–º–Ω–æ**.

---

## ‚úÖ –ï—Å—Ç—å –¥–≤–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞, –∏ –æ–±–∞ —Ä–∞–±–æ—á–∏–µ:

---

### üÖ∞ –í–∞—Ä–∏–∞–Ω—Ç 1: **–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `.min`**, –Ω–æ –ø—Ä–æ—Å—Ç–æ –Ω–µ –º–∏–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –≤ dev

–¢—ã —É–∂–µ **–ø—Ä–∏ `isProd = false`** –Ω–µ –º–∏–Ω–∏—Ñ–∏—Ü–∏—Ä—É–µ—à—å, –∞ –∑–Ω–∞—á–∏—Ç –º–æ–∂–Ω–æ:

```js
.pipe(rename({ suffix: '.min' }))
.pipe(gulpIf(isProd, cleanCSS()))
```

‚úÖ –¢–æ –µ—Å—Ç—å —Ñ–∞–π–ª **–≤—Å–µ–≥–¥–∞ –±—É–¥–µ—Ç –Ω–∞–∑—ã–≤–∞—Ç—å—Å—è `style.min.css`**,
–Ω–æ –≤ `dev` –æ–Ω –±—É–¥–µ—Ç –Ω–µ –º–∏–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω, –ø—Ä–æ—Å—Ç–æ –¥–ª—è –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏—è.
‚û° –í `index.html` —Ç—ã –ø—Ä–æ—Å—Ç–æ –ø–æ–¥–∫–ª—é—á–∞–µ—à—å:

```html
<link rel="stylesheet" href="css/style.min.css">
```

---

### üÖ± –í–∞—Ä–∏–∞–Ω—Ç 2: **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å HTML-—à–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä —Å –ª–æ–≥–∏–∫–æ–π**

üí• –í–æ—Ç –≥–¥–µ –≤—Å–ø–ª—ã–≤–∞–µ—Ç —Å–∏–ª–∞ `gulp-file-include`, `nunjucks`, `pug` –∏ —Ç.–ø.

–¢—ã –º–æ–∂–µ—à—å –≤ —à–∞–±–ª–æ–Ω–µ –≤—Å—Ç–∞–≤–ª—è—Ç—å:

```html
<link rel="stylesheet" href="css/style{{ suffix }}.css">
```

–ò –≤ `suffix` –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è:

* `.min` –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω–∞
* –ø—É—Å—Ç–æ –¥–ª—è –¥–µ–≤-—Ä–µ–∂–∏–º–∞

‚öôÔ∏è –ù–æ –¥–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ —É–∂–µ –ø–æ–¥–∫–ª—é—á–∞—Ç—å —à–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä —Å –ø–µ—Ä–µ–¥–∞—á–µ–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö.

---

## ‚ú® –ß—Ç–æ —è —Ä–µ–∫–æ–º–µ–Ω–¥—É—é —Ç–µ–±–µ —Å–µ–π—á–∞—Å

üëâ **–í–∞—Ä–∏–∞–Ω—Ç –ê ‚Äî —Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –∏ —Å—Ç–∞–±–∏–ª—å–Ω—ã–π**

* –û—Å—Ç–∞–≤—å `rename({ suffix: '.min' })` –≤—Å–µ–≥–¥–∞
* –ü–æ–¥–∫–ª—é—á–∞–π –≤ `index.html` –≤—Å–µ–≥–¥–∞ `style.min.css`
* –ü—Ä–æ—Å—Ç–æ –≤ –¥–µ–≤-—Ä–µ–∂–∏–º–µ –æ–Ω –Ω–µ –º–∏–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω, –Ω–æ –∏–º—è —Ç–æ –∂–µ ‚Üí –≤—Å—ë —Å—Ç–∞–±–∏–ª—å–Ω–æ

---

## üí¨ –ü—Ä–∏–º–µ—Ä –¥–ª—è SCSS –∑–∞–¥–∞—á–∏:

```js
.pipe(rename({ suffix: '.min' }))
.pipe(gulpIf(isProd, cleanCSS()))
```

## üí¨ –ü—Ä–∏–º–µ—Ä –¥–ª—è `index.html`:

```html
<link rel="stylesheet" href="css/style.min.css">
<script src="js/main.min.js"></script>
```

---

üß† –ê –∫–æ–≥–¥–∞ –Ω–∞—á–Ω—ë–º —Ä–∞–±–æ—Ç–∞—Ç—å —Å —à–∞–±–ª–æ–Ω–∞–º–∏ ‚Äî —Å–¥–µ–ª–∞–µ–º –∫—Ä–∞—Å–∏–≤–æ:
–µ—Å–ª–∏ `isProd`, —Ç–æ `.min`, –µ—Å–ª–∏ `!isProd` ‚Äî –ø—É—Å—Ç–æ, –∏ –±—É–¥–µ—Ç –≤—Å—ë –Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–µ üòé

–ì–æ—Ç–æ–≤ –ø–æ–≥—Ä—É–∂–∞—Ç—å—Å—è –≤ —à–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä—ã? –£ –Ω–∞—Å –≤–ø–µ—Ä–µ–¥–∏ `gulp-file-include`, `nunjucks`, `pug`, –∫–∞–∫ —Å–∫–∞–∂–µ—à—å ‚Äî –¥–≤–∏–Ω–µ–º!

## –û —à–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä–∞—Ö
–û—Ç–ª–∏—á–Ω–æ, —á—Ç–æ –º—ã –∫ —ç—Ç–æ–º—É –ø–æ–¥–æ—à–ª–∏! –î–∞–≤–∞–π —Ä–∞–∑–±–µ—Ä—ë–º—Å—è —Å–∏—Å—Ç–µ–º–Ω–æ:
**–∫–∞–∫–∏–µ HTML-—à–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä—ã —Ä–µ–∞–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞—é—Ç —Å Gulp 5.0.1** (ESM, Node 18+ –∏ —Ç.–¥.), –∫–∞–∫–∏–µ –∏–∑ –Ω–∏—Ö —É–¥–æ–±–Ω—ã, –∏ —á—Ç–æ –≤—ã–±—Ä–∞—Ç—å –ª–∏—á–Ω–æ —Ç–µ–±–µ.

---

## ‚úÖ –ê–∫—Ç—É–∞–ª—å–Ω—ã–µ HTML-—à–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä—ã –¥–ª—è Gulp 5.0.1 (ESM-—Å–±–æ—Ä–∫–∏)

| –ü–ª–∞–≥–∏–Ω                   | –®–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä                     | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Gulp 5.0.1         | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ ESM                | –£—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏        | –ü–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π                                  |
| ------------------------ | -------------------------------- | ---------------------------- | ---------------------------- | ------------------------ | ------------ | -------------------------------------------- |
| **gulp-file-include**    | –ù–∞—Ç–∏–≤–Ω—ã–π –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä (@include) | ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é                  | ‚úÖ (–≤ –æ–±—Ö–æ–¥)                  | üü¢ –ø—Ä–æ—Å—Ç–æ–π               | ‚≠ê‚≠ê‚≠ê‚≠ê         | –õ—É—á—à–∏–π —Å—Ç–∞—Ä—Ç, –ø–æ—á—Ç–∏ –Ω–µ —à–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä          |
| **gulp-nunjucks-render** | Nunjucks (Jinja-–ø–æ–¥–æ–±–Ω—ã–π)        | ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏ –ø–æ–¥ ESM | ‚ö†Ô∏è –ù–µ—Ç –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏ | üü° —Å—Ä–µ–¥–Ω–∏–π               | ‚≠ê‚≠ê‚≠ê          | –ú–æ—â–Ω—ã–π, –Ω–æ –Ω–µ –¥—Ä—É–∂–∏—Ç —Å ESM –∏–∑ –∫–æ—Ä–æ–±–∫–∏        |
| **gulp-pug**             | Pug (ex-Jade)                    | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç                   | ‚ö†Ô∏è ESM –≤—Ä—É—á–Ω—É—é               | üî¥ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å | ‚≠ê‚≠ê‚≠ê‚≠ê         | –ü–æ–ø—É–ª—è—Ä–µ–Ω, –Ω–æ –Ω–∞ –ª—é–±–∏—Ç–µ–ª—è                    |
| **gulp-ejs**             | EJS (–∫–∞–∫ JS-—à–∞–±–ª–æ–Ω—ã)             | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç                   | ‚ö†Ô∏è CommonJS                  | üü¢ –ø—Ä–æ—Å—Ç–æ–π               | ‚≠ê‚≠ê‚≠ê          | –õ–µ–≥–∫–æ –≤—Å—Ç—Ä–æ–∏—Ç—å, –Ω–æ –Ω–µ –¥–ª—è –º–æ–¥—É–ª—å–Ω—ã—Ö HTML     |
| **gulp-html-extend**     | –í—Å—Ç–∞–≤–∫–∞ layout –∏ –±–ª–æ–∫–æ–≤          | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç                   | ‚úÖ                            | üü¢ –ø—Ä–æ—Å—Ç–æ–π               | ‚≠ê‚≠ê           | –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ file-include, –Ω–æ –º–µ–Ω–µ–µ –∏–∑–≤–µ—Å—Ç–µ–Ω |

---

## üîç –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –ø–æ –∫–∞–∂–¥–æ–º—É

---

### 1. ‚úÖ **gulp-file-include**

üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞:

```bash
npm install --save-dev gulp-file-include
```

üîß –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

* –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `@@include('header.html')`
* –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: `@@include('head.html', { title: '–ì–ª–∞–≤–Ω–∞—è' })`
* –û—Ç–ª–∏—á–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è HTML-–≤–µ—Ä—Å—Ç–∫–∏
* –ù–µ —Ç—Ä–µ–±—É–µ—Ç —à–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä–æ–≤ ‚Äî –ø—Ä–æ—Å—Ç–æ —Ä–∞–∑–±–∏–≤–∫–∞ –ø–æ —á–∞—Å—Ç—è–º

‚úÖ **–ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–º–µ—Å—Ç–∏–º —Å Gulp 5 (ESM)** ‚Äî —É–∂–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ

---

### 2. ‚ö†Ô∏è **gulp-nunjucks-render**

üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞:

```bash
npm install --save-dev gulp-nunjucks-render nunjucks
```

üîß –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

* –õ–æ–≥–∏–∫–∞ –∫–∞–∫ –≤ Jinja: `{% include %}`, `{% block %}`, –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, `if`, `for`
* –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–∞–∫–µ—Ç–æ–≤, –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —à–∞–±–ª–æ–Ω–æ–≤
* ‚ö†Ô∏è –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ `require()` (—Ç–æ –µ—Å—Ç—å CommonJS)

üöß –í Gulp 5 (ESM) –Ω–∞–¥–æ –ø–∏—Å–∞—Ç—å –æ–±—ë—Ä—Ç–∫—É –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `gulpfile.cjs`
–ù–æ —ç—Ç–æ **—Å–∞–º—ã–π –º–æ—â–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç**, –µ—Å–ª–∏ –Ω—É–∂–µ–Ω –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π —à–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä

---

### 3. ‚ö†Ô∏è **gulp-pug**

üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞:

```bash
npm install --save-dev gulp-pug
```

üîß –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

* –°–∏–Ω—Ç–∞–∫—Å–∏—Å –∫–∞–∫ —É Python/Jade
* HTML –±–µ–∑ —É–≥–ª–æ–≤—ã—Ö —Å–∫–æ–±–æ–∫
* –õ—ë–≥–∫–∏–π –∏ –±—ã—Å—Ç—Ä—ã–π

‚ö†Ô∏è –ù–æ:

* –¢—Ä–µ–±—É–µ—Ç –ø—Ä–∏–≤—ã–∫–∞–Ω–∏—è
* –ù–µ –≤—Å–µ –¥–∏–∑–∞–π–Ω–µ—Ä—ã –∏–ª–∏ –∫–æ–º–∞–Ω–¥—ã –µ–≥–æ –ª—é–±—è—Ç

---

### 4. ‚úÖ **gulp-ejs**

üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞:

```bash
npm install --save-dev gulp-ejs
```

üîß –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

* –ö–∞–∫ JS-—à–∞–±–ª–æ–Ω: `<%= –∏–º—è %>`
* –£–¥–æ–±–Ω–æ –¥–ª—è –¥–∏–Ω–∞–º–∏–∫–∏ –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
* –•–æ—Ä–æ—à–æ —Å–æ—á–µ—Ç–∞–µ—Ç—Å—è —Å JSON-–¥–∞–Ω–Ω—ã–º–∏

‚ö†Ô∏è –ù–æ: –¥–ª—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã (`header`, `footer`, `layout`) ‚Äî –Ω–µ—É–¥–æ–±–µ–Ω

---

### 5. ‚úÖ **gulp-html-extend**

üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞:

```bash
npm install --save-dev gulp-html-extend
```

üîß –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

* –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `<!-- layout main.html -->` –∏ `<!-- block content -->`
* –ü—Ä–æ—Å—Ç–æ–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –¥–ª—è layout-based –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
* –ú–æ–∂–µ—Ç –±—ã—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–æ–π `file-include`

---

## üèÜ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –¥–ª—è —Ç–µ–±—è, –î–∞—è–Ω:

| –¶–µ–ª—å                                              | –ß—Ç–æ –≤—ã–±—Ä–∞—Ç—å                                       |
| ------------------------------------------------- | ------------------------------------------------- |
| –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ `header`, `footer`, `main`, –≤—Å—Ç–∞–≤–∫–∏ | ‚úÖ `gulp-file-include`                             |
| –ú–æ—â–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã, —Ü–∏–∫–ª—ã, —É—Å–ª–æ–≤–∏—è                    | ‚ö†Ô∏è `gulp-nunjucks-render` (–µ—Å–ª–∏ –≥–æ—Ç–æ–≤ –∫ CommonJS) |
| –ú–∏–Ω–∏–º–∞–ª–∏–∑–º –∏ HTML-–≤–µ—Ä—Å—Ç–∫–∞                         | ‚úÖ `gulp-html-extend`                              |
| –°–∏–Ω—Ç–∞–∫—Å–∏—Å –∫–∞–∫ —É Python                            | ‚ö†Ô∏è `gulp-pug`                                     |
| JS-—à–∞–±–ª–æ–Ω—ã, –ø—Ä–æ—Å—Ç—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ                    | ‚úÖ `gulp-ejs`                                      |

---

–•–æ—á–µ—à—å ‚Äî –Ω–∞—á–Ω—ë–º —Å `gulp-file-include`, —Ä–∞–∑–±–µ—Ä—ë–º—Å—è —Å `@@include`, –ø–æ—Ç–æ–º –º–æ–∂–Ω–æ –≤–Ω–µ–¥—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ –¥–∞–∂–µ –¥–µ–ª–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—ã (`index.html`, `about.html`, `contacts.html`) —Å –æ–¥–Ω–∏–º `layout.html`.

–ì–æ—Ç–æ–≤ –ø—Ä—ã–≥–Ω—É—Ç—å ‚Äî –ø–æ–µ—Ö–∞–ª–∏ üöÄ
